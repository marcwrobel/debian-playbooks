---
packages__host_list:
  - 'htop' # Interactive process viewer
packages__host_blacklist:
  - 'cloud-init' # cloud-init does not setup IPv6 and configure IPv4 using DHCP

network__interface: 'eno0'
network__ipv4_address: '5.196.89.31'
network__ipv4_gateway: '5.196.95.254'
network__ipv6_address: '2001:41d0:a:fc1f::1'
network__ipv6_gateway: '2001:41d0:a:fcff:ff:ff:ff:ff'

sysctl__hosts_additional_variables:
  - net.ipv6.conf.all.autoconf:
      description: >-
        IPv6 auto-configuration is causing issues on Kimsufi server.
        See https://docs.ovh.com/fr/dedicated/network-ipv6/.
      value: 0
  - net.ipv6.conf.all.accept_ra:
      description: >-
        IPv6 Router Advertisements is causing issues on Kimsufi server.
        See https://docs.ovh.com/fr/dedicated/network-ipv6/.
      value: 0

s1__private_ipv4: !vault |
  $ANSIBLE_VAULT;1.1;AES256
  30346335356333626238386163616361373936313832316262663037323736643662333532323366
  3335643435636364363332346235333738643763363430370a303532393964326564613964386531
  32303734656232373663386338303333616134626562393732623961313061663735373561383436
  6664643537323764620a366632303362346265666564626335653763666236396361313035613466
  3166
s1__private_ipv6: !vault |
  $ANSIBLE_VAULT;1.1;AES256
  36386439366161656435626130666134613162303366623431353861636235653764333964353634
  3962373063333563353039616530653936656365393863660a333632396330653238376261666237
  63363837656633306661383330613265336436383433643362356534346230363034346339383937
  3830643735353331330a346432396362393661656538383732343335393661316133323537656537
  36623038663133663231366536306266343435396338363135376263383935623963
firewalld__sources:
  - { zone: 'trusted', source: '{{ s1__private_ipv4 }}', permanent: true, state: 'enabled', immediate: true }
  - { zone: 'trusted', source: '{{ s1__private_ipv6 }}', permanent: true, state: 'enabled', immediate: true }

firewalld__services:
  - { zone: 'trusted', service: 'ssh', permanent: true, state: 'enabled', immediate: true }
  - { zone: 'public', service: 'http', permanent: true, state: 'enabled', immediate: true }
  - { zone: 'public', service: 'https', permanent: true, state: 'enabled', immediate: true }
  - { zone: 'public', service: 'dhcpv6-client', permanent: true, state: 'disabled', immediate: true }
  - { zone: 'public', service: 'ssh', permanent: true, state: 'disabled', immediate: true }

apache_server__state: 'present'
apache_server__bindings:
  - name: 'ipv4'
    ip: '{{ network__ipv4_address }}'
    ports: [80, 443]
  - name: 'ipv6'
    ip: '[{{ network__ipv6_address }}]'
    ports: [80, 443]
